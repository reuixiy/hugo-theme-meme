{{- $scratch := . -}}
{{- $ := $scratch.Get "$" -}}

{{- $scratch.Add "externalScripts" (slice "https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js") -}}
{{- if ne $.Site.Language.Lang "en" -}}
    {{- $supported := slice "ar" "da" "de" "du" "es" "fi" "fr" "hu" "it" "ja" "nl" "no" "pt" "ro" "ru" "sv" "tr" "vi" -}}
    {{- if in $supported $.Site.Language.Lang -}}
        {{- $scratch.Add "externalScripts" (slice "https://cdn.jsdelivr.net/npm/lunr-languages@1.4.0/min/lunr.stemmer.support.min.js") -}}
        {{- $scratch.Add "externalScripts" (slice (printf "https://cdn.jsdelivr.net/npm/lunr-languages@1.4.0/min/lunr.%s.min.js" $.Site.Language.Lang)) -}}
    {{- else -}}
        {{- warnf "The site language %q isn't supported by lunr, the search results might be suboptimal. Supported languages are: %q" $.Site.Language.Lang $supported -}}
    {{- end -}}
{{- end -}}

{{- $scratch.Add "scripts" (partial "utils/process-script.html" (dict "$" $ "script" "js/lunr-search.js")) -}}
